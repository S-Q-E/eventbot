{% extends 'admin/master.html' %}
{% block body %}
<style>
    .scroll-table-container {
        max-height: 500px;
        overflow-y: auto;
        margin-bottom: 20px;
        border: 1px solid #ccc;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 10px;
        border: 1px solid #ccc;
        text-align: left;
        vertical-align: top;
    }

    select {
        width: 100%;
        min-height: 100px;
    }

    .save-btn-container {
        text-align: center;
        margin-top: 20px;
    }

    .save-btn {
        padding: 10px 20px;
        background-color: #2c89e2;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .save-btn:hover {
        background-color: #216bb4;
    }

    .flash-message {
        padding: 10px;
        margin-bottom: 20px;
        border-radius: 5px;
    }

    .flash-success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .flash-error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }
</style>

<h2>Редактирование интересов пользователей</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="flash-message flash-{{ category }}">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<form method="POST" action="{{ url_for('interestsview.index') }}">
    <div class="scroll-table-container">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Имя пользователя</th>
                    <th>Интересы</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.id }}</td>
                    <td>{{ user.username or (user.first_name ~ ' ' ~ user.last_name) }}</td>
                    <td>
                        <select name="interests_{{ user.id }}" multiple>
                            {% for cat in all_categories %}
                                <option value="{{ cat.id }}"
                                    {% if cat in user.interests %}selected{% endif %}>
                                    {{ cat.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="save-btn-container">
        <button type="submit" class="save-btn">Сохранить изменения</button>
    </div>
</form>
{% endblock %}
