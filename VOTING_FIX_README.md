# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –∑–∞ –ª—É—á—à–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –Ω–µ–¥–µ–ª–∏

## üêõ –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤ Telegram Poll –∏–≥—Ä–æ–∫ –Ω–∞–±–∏—Ä–∞–ª –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤, –Ω–æ –±–æ—Ç –≤—ã–¥–∞–≤–∞–ª –¥—Ä—É–≥–æ–≥–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è.

## üîç –ü—Ä–∏—á–∏–Ω–∞
–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `handle_poll` –≤ —Ñ–∞–π–ª–µ `handlers/vote.py`. –ö–æ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª, —á—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ—Ä—è–¥–∫—É –æ–ø—Ü–∏–π –≤ Telegram Poll, –Ω–æ —ç—Ç–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ.

**–°—Ç–∞—Ä—ã–π –∫–æ–¥:**
```python
candidates = db.query(User).filter(User.is_mvp_candidate == True).all()
for i, option in enumerate(poll.options):
    if i < len(candidates):
        candidates[i].votes = option.voter_count  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
```

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–æ–≤ (`utils/mvp_poll.py`)
- **–î–æ–±–∞–≤–ª–µ–Ω—ã ID –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ –æ–ø—Ü–∏–∏ –æ–ø—Ä–æ—Å–∞:**
  ```python
  option_text = f"{candidate.first_name} {candidate.last_name} (ID:{candidate.id})"
  ```
- **–£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞

### 2. –ü–µ—Ä–µ–ø–∏—Å–∞–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è (`handlers/vote.py`)
- **–ù–æ–≤–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ ID:**
  ```python
  # –ò–∑–≤–ª–µ–∫–∞–µ–º ID –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –æ–ø—Ü–∏–∏
  if "(ID:" in option.text:
      id_start = option.text.find("(ID:") + 4
      id_end = option.text.find(")", id_start)
      candidate_id = int(option.text[id_start:id_end])
      
      # –ù–∞—Ö–æ–¥–∏–º –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –ø–æ ID
      candidate = next((c for c in candidates if c.id == candidate_id), None)
  ```
- **–î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –∏ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–í `announce_winner()`** –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏ –∏—Ö –≥–æ–ª–æ—Å–æ–≤
- **–í `end_voting()`** –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
- **–í `handle_poll()`** –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥–æ–ª–æ—Å–æ–≤

### 4. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–ª–∞–¥–∫–∏
- **`debug_voting_status()`** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `test_voting_fix.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã.

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –æ–ø—Ä–æ—Å–∞—Ö
**–ë—ã–ª–æ:**
```
- –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
- –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤
- –°–∏–¥–æ—Ä –°–∏–¥–æ—Ä–æ–≤
```

**–°—Ç–∞–ª–æ:**
```
- –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (ID:123)
- –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤ (ID:456)
- –°–∏–¥–æ—Ä –°–∏–¥–æ—Ä–æ–≤ (ID:789)
```

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è** –æ–ø—Ü–∏–π –∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ ID
3. **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö** –≤ —á–∞—Ç

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç
–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã Telegram Poll —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∏—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID, —á—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è. 